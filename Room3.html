<!DOCTYPE html>
<html>

<head>

    <title>Ship Deck</title>

    <link rel="stylesheet" href="SpaceStyleSheet.css">

    <style>

        /* .memory:before {
            position: absolute;
            content: "";
            background-color: #101010;
            height: 13.75em;
            width: 13.75em;
            z-index: 1;
            transform: translate(-50%, -50%);
            top: 50%;
            left: 50%;
            border-radius: 50%;
        } */

        #count {
            background-color: #ffffff;
            font-size: 3em;
            height: 2em;
            width: 3em;
            place-items: center;
            border-radius: 0.3em;
            display: block;
            margin: auto;
        }
    </style>
</head>

<body>
    <div id="wrapper">

        <!-- Column 1 - Where the photo is  -->
        <div id="col1">
            <h1>Ship Deck</h1>

            <!-- The main photo  -->
            <div id="room3" class="showMe">
                <img class="centre" src="images/Room3.png" style="width:90%;" alt="Photo of the Ship Deck" />
            </div>

            <!-- Memory Game  -->
            <div id="memory" class="hideMe">
                <br>
                <div id="count">00</div>
                <br><br>
                <div id="colours" class="colourGreen"></div>
                <div id="colours" class="colourRed"></div>
                <div id="colours" class="colourBlue"></div>
                <div id="colours" class="colourYellow"></div>

            </div>

        </div>


        <!-- column 2 - where the buttons go -->
        <div id="col2">
            <h1>Room 3</h1>
            <div id="RoomButtons">
                <button id="previousRoom" onclick="previousRoom()">Previous Room</button>
                <button id="nextRoom" onclick="nextRoom()">Next Room</button>
            </div>
            <h4>What do you want to do?</h4>
            <br>
            <button onclick="crowbarDoor();" class="button">Try crowbar on door</button>
            <button onclick="crowbarPickup();" class="button">Pick up crowbar</button>
            <button onclick="lever();" class="button">Flick Lever</button>
            <button onclick="memoryGame();" class="button">Examine podium</button>
            <button onclick="" class="button">Try crowbar on door</button>
        </div>
    </div>

    <script>
        let crowbar = 0;
        function nextRoom() {

            window.location.replace("Room4.html")
        }

        function previousRoom() {

            window.location.replace("Room2.html")
        }

        function crowbarPickup() {
            crowbar = 1;
            window.alert("You picked up the crowbar.");



        }

        function crowbarDoor() {
            if (crowbar == 1) {
                window.alert("You run towards the door at full speed swinging your crowbar and when you get to the door you swing the crowbar as hard as you can and it bounces offâ€¦ it hits you in your head, you feel dizzy.");

            } else {
                window.alert("You do not have the crowbar in your inventory.");
            }

        }

        function lever() {
            window.alert("Aww a cute little spinglespop appears. You should name it!");


        }

        const colors = {
            colourGreen: {
                current: "1e7021",
                new: "#1fbf24",
            },
            colourRed: {
                current: "#630e0e",
                new: "#d42020",
            },
            colorBlue: {
                current: "#202257",
                new: "#262bc7",
            },
            colorYellow: {
                current: "#7a7a14",
                new: "#dbdb39",
            }
        };

        const colours = document.getElementById("colours");
        let randomColour = [];


        function memoryGame() {
            randomColour = [];
            let pathGeneratorBool = false;
            let count,
                clickCount = 0;
            document.getElementById("memory").className = "showMe";
            document.getElementById("room3").className = "hideMe";

            //Function to decide the sequence
            const pathGenerate = () => {
                randomColors.push(generateRandomValue(colours));
                count = randomColors.length;
                pathGeneratorBool = true;
                pathDecide(count);
            };
            //Function to get a random value from object
            const generateRandomValue = (obj) => {
                let arr = Object.keys(obj);
                return arr[Math.floor(Math.random() * arr.length)];
            };
            //Function to play the sequence
            const pathDecide = async (count) => {
                countValue.innerText = count;
                for (let i of randomColors) {
                    let currentColor = document.querySelector(`.${i}`);
                    await delay(500);
                    currentColor.style.backgroundColor = `${colors[i]["new"]}`;
                    await delay(600);
                    currentColor.style.backgroundColor = `${colors[i]["current"]}`;
                    await delay(600);
                }
                pathGeneratorBool = false;
            };
            //Delay for blink effect
            async function delay(time) {
                return await new Promise((resolve) => {
                    setTimeout(resolve, time);
                });
            }
            //When user click on the colors
            colorPart.forEach((element) => {
                element.addEventListener("click", async (e) => {
                    //if user clicks the same color then next level
                    if (pathGeneratorBool) {
                        return false;
                    }
                    if (e.target.classList[0] == randomColors[clickCount]) {
                        //Color blick effect on click
                        e.target.style.backgroundColor = `${colors[randomColors[clickCount]]["new"]
                            }`;
                        await delay(500);
                        e.target.style.backgroundColor = `${colors[randomColors[clickCount]]["current"]
                            }`;
                        //User click
                        clickCount += 1;
                        //Next level if number of valid clicks == count
                        if (clickCount == count) {
                            clickCount = 0;
                            pathGenerate();
                        }
                    } else {
                        lose();
                    }
                });
            });
            //Function when player executes wrong sequence
            const lose = () => {
                result.innerHTML = `<span> Your Score: </span> ${count}`;
                result.classList.remove("hide");
                container.classList.remove("hide");
                wrapper.classList.add("hide");
                startButton.innerText = "Play Again";
                startButton.classList.remove("hide");
            };



        }

    </script>
</body>

</html>