<!DOCTYPE html>
<html>

<head>

    <link rel="stylesheet" href="SpaceStyleSheet.css">

    <title>Common Room</title>

    <link rel="stylesheet" href="SpaceStyleSheet.css">

    <style>
        .header {
            grid-area: hd;
        }

        .timerBox {
            grid-area: tbx;

            font-size: 10px;

            text-align: center;
            background-color: rgba(211, 211, 211, 0.1);

            border: thick;
            border-color: pink;

            padding: 3%;

            margin-left: 5%;
            margin-right: 5%;
            margin-top: 3%;
            margin-bottom: 3%;
        }

        .interactionBox {
            grid-area: ibx;
            text-align: center;
            background-color: rgba(211, 211, 211, 0.1);
            border: thick;
            border-color: pink;
            margin-left: 5%;
            margin-right: 5%;
            margin-top: 3%;
            margin-bottom: 3%;
            padding-top: 5px;
            padding-bottom: 5px;
        }

        .wrapper {

            color: white;


            margin: auto;
            margin-top: 50px;
            padding-top: 10px;

            gap: 10px;
        }

        .txtBxBtn {

            background-color: lightgray;
        }

        #start {

            background-color: black;
            color: white;
            text-align: center;

        }

        .col2 {

            background-image: "images/Room1.png";
        }

      
    </style>
</head>

<body>
    <div class="wrapper">

        <div id="col1">

            <!--This is the div that controls the light-->
            <div id="light"></div>

            <h1>Room 1 - Common Room</h1>


            <!-- The main photo  -->
            <div id="backgroundImg" class="showMe">
                <img class="centre" src="images/Room1.png" style="width:90%;" alt="Common Room" />
            </div>

            <!-- Different endings -->
            <div id="airlockImg" class="hideMe">
                <img class="centre" src="images/Airlock.png" style="width:90%;" alt="Airlock Endcard" />
            </div>
        </div>


        <div id="col2" class="showMe">

            <div class="header">

                <h1>Room 1</h1>

                <h1>Time Remaining: <span id="timerText">?</span></h1>



                <button id="goToRoom2" onclick="goToRoom2()">Ship Deck</button>
                <button id="goToRoom3" onclick="goToRoom3()">Electric Storage Room</button>

            </div>

            <div class="timerBox">

                <h1>Time Remaining: <span id="timerText">?</span></h1>
                

            </div>

            <div class="interactionBox">

                <p id="textOutput"> Would you like to 'Look Around' or try and 'Turn On' the lights?</p>

                <button id="Wire" class="hideMe" onclick="Wire()">Examine Wire</button>
                <button id="door1" class="hideMe" onclick="door1()">Try Opening Door 1</button>
                <button id="door2" class="hideMe" onclick="door2()">Try Opening Door 2</button>
                <button id="airlock" class="hideMe" onclick="airlock()">Jump out the Airlock</button>
                <button id="lookAround" class="showMe" onclick="lookAround()">Look Around</button>
                <button id="turnOn" class="showMe" onclick="turnOn()">Turn On Torch</button>
                <button id="stickyNote" class="hideMe" onclick="stickyNote()">Look At Sticky Note</button>



                <form id="inputForm" class="hideMe" onsubmit="input()">

                    <input id="text" type="text" name="userInput">
                    <br>
                    <input class="button" id="submit" type="submit">

                </form>
            </div>

        </div>
    </div>







    <script>

        //0 means not picked up yet
        //sessionStorage.setItem("WireCoil", 0);

        //0 means the torch is on

        let myNum = sessionStorage.getItem("Torch")
        myNum = Number(myNum);
        console.log("Torch is " + myNum);
        if (myNum == 1) {
            //turns off the light
            var div = document.getElementById("light");  
            div.setAttribute("id", "newDivID");
        } 

        //torch
        var pos = document.documentElement;
        pos.addEventListener('mousemove', e => {
            pos.style.setProperty('--x', e.clientX + 'px')
            pos.style.setProperty('--y', e.clientY + 'px')
        })

        //text for screen functions

        function startingText() {

            document.getElementById("textOutput").innerHTML = "Welcome to the Spaceship. For the immediacy, you have 2 options, either look around the 'room?' you seem to be in, or attemp to turn on your torch.";
        }

        function textUpdateLookAroundLight() {

            document.getElementById("textOutput").innerHTML = "Looking Around You see the outline of 2 doors <br> an airlock <br> and a Coil of Wire";
        }

        function textUpdateLookAroundDark() {

            document.getElementById("textOutput").innerHTML = "You Attempt to Look Around but cannot due to the dark. Perhaps try turning on your torch?";
        }

        function textUpdateLookAroundPostTorch() {

            document.getElementById("textOutput").innerHTML = "Looking Around You see the outline of 2 doors <br> an airlock <br> and a ...'add other item here'";
        }

        function textUpdateExamineWire() {

            document.getElementById("textOutput").innerHTML = "Add Wire to Inventory";
        }

        function textUpdateDoor1Locked() {

            document.getElementById("textOutput").innerHTML = "Door is Locked! You may need to override the locking mechanism with an overdose of electricity if you can find any?";
        }

        function textUpdateDoor2Locked() {

            document.getElementById("textOutput").innerHTML = "Locked - Pin is Required to Open Door";
        }

        function textUpdateDoor2Unlocking() {

            document.getElementById('textOutput').innerHTML = "Please Enter Pin";
        }

        function textUpdateDoor2Unlocked() {

            document.getElementById('textOutPut').innerHTML = "Door 2 Unlocked";
        }

        function textUpdateAirlock() {

            document.getElementById("textOutput").innerHTML = "Well done, you chose death, Goodbye!";
        }

        function textUpdateTurnOn() {

            document.getElementById("textOutput").innerHTML = "Torch On Successfully";
            document.getElementById("textOutput").innerHTML = "I suggest you begin looking around.";
        }


        //
        //
        //Functions Connected to Buttons
        //
        //


        function Wire() {

            sessionStorage.setItem("WireCoil", 1);

            textUpdateExamineWire();
            addWireToInventory();


            var a = document.getElementById("Wire");
            var b = document.getElementById("door1");
            var c = document.getElementById("door2");
            var d = document.getElementById("airlock");
            var e = document.getElementById("lookAround");
            var f = document.getElementById("turnOn");


            a.style.display = "none";
            b.style.display = "initial";
            c.style.display = "initial";
            d.style.display = "initial";
            e.style.display = "none";
            f.style.display = "none";


        }

        var door1Status = 1;// closed = 0, open = 1

        function goToRoom2() {


            if (door1Status == 0) {

                textUpdateDoor1Locked();

            } else if (door1Status == 1) {

                window.location.replace("3ShipDeck.html")


            } else {
                window.alert('Error');
            }



        }

        var door2Status = 1;// closed = 0, open = 1

        function goToRoom3() {


            if (door2Status == 0) {

                textUpdateDoor2Locked();

            } else if (door2Status == 1) {

                window.location.replace("2ElectricityRoom.html")

            } else {
                //Add Error Service Here
            }



        }

        function door1() {

            textUpdateDoor1Locked();
            //deal with session storage to open door
        }



        function door2() {

            textUpdateDoor2Unlocking();

            var a = document.getElementById("inputForm");
            a.style.display = "initial";

            unlockDoor2();
        }

        function unlockDoor2() {

            let pin = document.forms["inputForm"]["userInput"].value;

            if (pin == "1234") {

                textUpdateDoor2Unlocked();
                door2Status = 1;

            } else {

                window.alert("Error");
            }


        }


        function airlock() {

            textUpdateAirlock();
            window.location.replace("Airlock_ending.html")

            var e = document.getElementById("airlock");
            e.style.display = "none";
        }



        function lookAround() {

            if (torchState == 0) {

                textUpdateLookAroundDark();

            } else if (torchState == 1) {

                textUpdateLookAroundLight();

                var a = document.getElementById("Wire");
                var b = document.getElementById("door1");
                var c = document.getElementById("door2");
                var d = document.getElementById("airlock");
                var e = document.getElementById("lookAround");
                var f = document.getElementById("stickyNote");



                a.style.display = "initial";
                b.style.display = "initial";
                c.style.display = "initial";
                d.style.display = "initial";
                e.style.display = "none";
                f.style.display = "initial";


            } else {

                window.alert("The Torch Has Lost Its Batteries, Errors Have Occured")
            }
        }


        var torchState = 0;

        function turnOn() {

            //Add method for torch here!
            window.alert("Current Output to inform torch is on");

            torchState = torchState + 1;


            var a = document.getElementById("lookAround");
            var b = document.getElementById("turnOn");

            a.style.display = "initial";
            b.style.display = "none";




        }

        function stickyNote() {

            //add link to random number on sitcky note here
        }





        //
        //
        //Functions to operate gamaplay
        //
        //

        /*function input() {

            let x = document.forms["inputForm"]["userInput"].value;

            if (x == "Look Around") {
                // window.alert("Call Method to trigger look around method");
                lookAround();
            } else if (x == "Turn On") {

                turnOn();
            } else {
                window.alert("Invalid Response, maybe try one of the suggested Prompts");
            }
        }*/




        var locked = 0;

        function unlockDoor() {



            function textUpdateIncorrectPin() {

                document.getElementById("textOutput").innerHTML = "Incorrect Pin, Please Try Again!";

            }

            function textUpdateCorrectPin() {

                document.getElementById("textOutput").innerHTML = "Correct Pin, Door Now Open";

            }

        }

        ////Methods Yet to Be Written
        ///
        /*addWireToInventory(){
            implement session Storage for Room 2


        }
            */
        //
        ////




        //Session scripts
        // Initial timer (default vaulue is 1000 seconds)
        if (!sessionStorage.getItem('timeRem')) {
            sessionStorage.setItem('timeRem', '1000');
        }

        // Timer with the remaining time
        function startTimer() {
            var timeRem = sessionStorage.getItem('timeRem');
            document.getElementById('timerText').innerHTML = timeRem;
            timer = setInterval(countdown, 1000);
        }

        // Save the remaining time in the session storage before navigating to another page
        function saveTimeRem() {
            var timeRem = document.getElementById('timerText').innerHTML;
            sessionStorage.setItem('timeRem', timeRem);
        }

        // Load the remaining time from the session storage and start the timer with it
        function loadTimeRem() {
            var timeRem = sessionStorage.getItem('timeRem');
            document.getElementById('timerText').innerHTML = timeRem;
            timer = setInterval(countdown, 1000);
        }

        // Update the timer display and store the remaining time in the session storage every second
        function countdown() {
            var timeRem = document.getElementById('timerText').innerHTML;
            if (timeRem > 0) {
                timeRem--;
                document.getElementById('timerText').innerHTML = timeRem;
                sessionStorage.setItem('timeRem', timeRem);
            } else {
                clearInterval(timer);
                document.getElementById('timerText').innerHTML = 'END';
                timeRem = 10;
                // Redirect to statistics page
                //turned off for development
                //window.location.href = 'stats.html';
            }
        }

        // Register a beforeunload event listener to save the remaining time before navigating away from the page
        window.addEventListener('beforeunload', saveTimeRem);

        // Load the remaining time and start the timer when the page loads
        window.addEventListener('load', loadTimeRem);







    </script>




</body>

</html>