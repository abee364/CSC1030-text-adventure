<!DOCTYPE html>
<html>

<head>
	<title>Gallery</title>
	<link rel="stylesheet" href="SpaceStyleSheet.css">
</head>
<style>
	body {
		background-size: cover;
		background-attachment: fixed;
	}

	
</style>

<body>
	<div id="wrapper">
		<!-- Column 1 - Where the photo is  -->
		<div id="col1">
			<h1>Gallery</h1>

			<!-- The main photo  -->
			<div id="main" class="showMe">
				<img class="centre" src="images/Room4.png" style="width:90%;" alt="Gallery" />
			</div>
			<div id="fire" class="hideMe">
				<img class="centre" src="images/room4_no_fireextingisher.png" style="width:90%;" alt="Gallery" />
			</div>
		</div>
		<div id="col2" class="showMe">

			<h1>Gallery</h1>
			<h1>Time Remaining: <span id="timerText">?</span></h1>
			<div id="RoomButtons">
                <button id="previousRoom" onclick="previousRoom()" class="button">Previous Room</button>
            </div>
			<div id="Room5Buttons">

				<p>You have reached a critical decision point. Attempt to save everyone or escape?</p>
				<br>
				
				<button id="extinguisher" class="button" onclick="grabExtinguisher()">Grab fire extinguisher</button>
				<button id="escape-button" class="button" onclick="escape()">Escape</button>
				<button id="save-button" class="button" onclick="save()">Save Everyone</button>

			</div>
		</div>
	</div>

	<script>
		
		function escape() {
			// code to execute when Escape button is clicked
			window.alert("You have chosen to escape! Head to the escape pod...");
			window.location.href = "5EscapePod.html";
		}
		function save() {
			// code to execute when Save Everyone button is clicked
			window.alert("You have chosen to attempt to save everyone! Onto the control room...");
			window.location.href = "6ControlRoom.html";
		}


		function nextRoom() {

			window.location.replace("5EscapePod.html")
		}


		function previousRoom() {

			window.location.replace("3ShipDeck.html")
		}

		//Session scripts
		let extinguisher = 0;
		function grabExtinguisher() {
    		if (extinguisher == 0) {
        		extinguisher = 1;
        		sessionStorage.setItem('extinguisher', extinguisher);
        		document.getElementById('main').innerHTML = '<img class="centre" src="images/room4_no_fireextingisher.png" style="width:90%;" alt="Gallery" />';
    		}	
		}

        
		// Initial timer (default vaulue is 1000 seconds)
        if (!sessionStorage.getItem('timeRem')) {
            sessionStorage.setItem('timeRem', '1000');
        }

        // Timer with the remaining time
        function startTimer() {
            var timeRem = sessionStorage.getItem('timeRem');
            document.getElementById('timerText').innerHTML = timeRem;
            timer = setInterval(countdown, 1000);
        }

        // Save the remaining time in the session storage before navigating to another page
        function saveTimeRem() {
            var timeRem = document.getElementById('timerText').innerHTML;
            sessionStorage.setItem('timeRem', timeRem);
        }

        // Load the remaining time from the session storage and start the timer with it
        function loadTimeRem() {
            var timeRem = sessionStorage.getItem('timeRem');
            document.getElementById('timerText').innerHTML = timeRem;
            timer = setInterval(countdown, 1000);
        }

        // Update the timer display and store the remaining time in the session storage every second
        function countdown() {
            var timeRem = document.getElementById('timerText').innerHTML;
            if (timeRem > 0) {
                timeRem--;
                document.getElementById('timerText').innerHTML = timeRem;
                sessionStorage.setItem('timeRem', timeRem);
            } else {
                clearInterval(timer);
                document.getElementById('timerText').innerHTML = 'END';
                timeRem = 10;
                // Redirect to statistics page
                window.location.href = 'stats.html';
            }
        }

        // Register a beforeunload event listener to save the remaining time before navigating away from the page
        window.addEventListener('beforeunload', saveTimeRem);

        // Load the remaining time and start the timer when the page loads
        window.addEventListener('load', loadTimeRem);


	</script>
</body>

</html>