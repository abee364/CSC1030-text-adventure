<!DOCTYPE html>
<html>

<head>
    <title>Opening Monologue</title>
    <link rel="stylesheet" href="SpaceStyleSheet.css">
</head>

<body>
    <div class="container">
        <img src="images/Room1.png" alt="Room1" style="width:90%;">
        <div class="text-block">
            <h1>Time Remaining: <span id="timerText">?</span></h1>
            <p id="greeting">Computer: Hello there <span id="name"></span> we have a problem, the ship seems to have malfunctioned 
                and as such our systems have begun rapidly failing and…”</p>
            <p>“WARNING LIGHTS FAILING IN 3, 2, 1. Switching to back-up generator”</p>
            <!-- Room Becomes Mildly Darker But Not Pitch Black -->
            <p>“Well as I was saying our systems are failing, including all vital systems and a gas leak has broken
                out in the control room which is also on fire.
                I suggest you hurry before the fire ignites the gas and explodes the ship.
                You also should know that you only have 5 minutes before the gas leaks into the filteration system.
                So get going!
                And good luck!” </p>
            <button onclick="Start();">Start</button>

        </div>
    </div>

    <script>
         function Start() {
            window.location.replace("1CommonRoom.html")
        }

        // Name from home page
        var name = sessionStorage.getItem('name');

        // Display the user's name
        document.getElementById('name').innerHTML = name;

        // Initial timer (default vaulue is 1000 seconds)
        if (!sessionStorage.getItem('timeRem')) {
            sessionStorage.setItem('timeRem', '1000');
        }

        // Timer with the remaining time
        function startTimer() {
            var timeRem = sessionStorage.getItem('timeRem');
            document.getElementById('timerText').innerHTML = timeRem;
            timer = setInterval(countdown, 1000);
        }

        // Save the remaining time in the session storage before navigating to another page
        function saveTimeRem() {
            var timeRem = document.getElementById('timerText').innerHTML;
            sessionStorage.setItem('timeRem', timeRem);
        }

        // Load the remaining time from the session storage and start the timer with it
        function loadTimeRem() {
            var timeRem = sessionStorage.getItem('timeRem');
            document.getElementById('timerText').innerHTML = timeRem;
            timer = setInterval(countdown, 1000);
        }

        // Update the timer display and store the remaining time in the session storage every second
        function countdown() {
            var timeRem = document.getElementById('timerText').innerHTML;
            if (timeRem > 0) {
                timeRem--;
                document.getElementById('timerText').innerHTML = timeRem;
                sessionStorage.setItem('timeRem', timeRem);
            } else {
                clearInterval(timer);
                document.getElementById('timerText').innerHTML = 'END';
                timeRem = 10;
                // Redirect to statistics page
                window.location.href = 'stats.html';
            }
        }

        // Register a beforeunload event listener to save the remaining time before navigating away from the page
        window.addEventListener('beforeunload', saveTimeRem);

        // Load the remaining time and start the timer when the page loads
        window.addEventListener('load', loadTimeRem);

        function Start() {
            window.location.replace("Room1.html")
        }

    </script>
</body>

</html>